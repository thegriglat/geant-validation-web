<h1 class="pageheader">User layouts</h1>
<div class="ui grid">
    <div class="four wide column">
        <div class="ui segment">
            <h3>Template</h3>
            <sui-select class="selection container" [(ngModel)]="currentLayout" [options]="pTemplates"
                [isSearchable]="true" [isDisabled]="false" [optionFormatter]="layoutFormatter"
                (selectedOptionChange)="onSelectLayout($event)" #select>
                <ng-container *ngFor="let layout of select.filteredOptions">
                    <sui-select-option *ngIf="isLayoutShown(layout[1].tags)" [value]="layout">
                    </sui-select-option>
                </ng-container>
            </sui-select>
            <h4>Layout groups</h4>
            <div *ngFor="let tag of uniqueTags(pTemplates)">
                <sui-checkbox (click)="updateTags(tag)">{{tag}}</sui-checkbox>
            </div>
            <div class="ui  divider"></div>
            <sui-checkbox class="toggle" [(ngModel)]="useMarkers">Use markers</sui-checkbox>
        </div>
        <div class="ui segment container" *ngIf="currentLayout">
            <h3>Version</h3>
            <div class="ui active inverted dimmer" *ngIf="!menuLoaded">
                <div class="ui loader"></div>
            </div>
            <sui-multi-select class="selection container" [(ngModel)]="versionsSel" [options]="menuVersions"
                [isSearchable]="true" [isDisabled]="false" [optionFormatter]="versionFormatter"
                [optionsFilter]="versionSelectFilter" #multiSelect>
                <sui-select-option *ngFor="let obj of multiSelect.filteredOptions" [value]="obj">
                </sui-select-option>
            </sui-multi-select>
        </div>
        <div class="ui segment container" *ngIf="currentLayout">
            <h3>Physics List/Model</h3>
            <div class="ui active inverted dimmer" *ngIf="!menuLoaded">
                <div class="ui loader"></div>
            </div>
            <sui-multi-select class="selection container" [(ngModel)]="modelsSel" [options]="models"
                [isSearchable]="true" [isDisabled]="false" #multiSelect>
                <sui-select-option *ngFor="let obj of multiSelect.filteredOptions" [value]="obj">
                </sui-select-option>
            </sui-multi-select>
        </div>
        <div class="ui segment container" *ngIf="currentLayout">
            <h3>Reference data</h3>
            <div class="ui active inverted dimmer" *ngIf="!menuLoaded">
                <div class="ui loader"></div>
            </div>
            <div *ngFor="let e of availableExpDataforTest">
                <sui-checkbox (click)="updateExp(e)">{{e.expname}}</sui-checkbox>
            </div>
        </div>
        <button class="ui primary button container" *ngIf="currentLayout" [ngClass]="{disabled: updateCantPlot()}"
            (click)="magic()">
            Submit
        </button>
    </div>
    <div class="twelve wide column" *ngIf="magicPressed">
        <div class="ui grid">
            <div class="ui row" *ngFor="let row of plots">
                <ng-container *ngFor="let plot of row">
                    <div class="ui" [ngClass]="columnClass(row.length)" *ngIf="plot.type !== 'text'">
                        <app-plot [configObs]="getPlotConfig(plot)"></app-plot>
                        <ng-katex *ngIf="plot.title !== ''" [equation]="plot.title"></ng-katex>
                    </div>
                    <ng-katex [equation]="plot.text" *ngIf="plot.type === 'text'"></ng-katex>
                </ng-container>
            </div>
        </div>
    </div>
</div>